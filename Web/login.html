 <!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link rel="stylesheet" href="./assets/styles/login_styles.css">
    <style>
        /* 모달 팝업 스타일 */
        .modal {
            display: none; /* 기본적으로 숨김 상태 */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 20px;
            border: 1px solid #888;
            width: 100%;
            max-width: 400px;
            text-align: center;
            border-radius: 8px;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        .button-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            justify-content: center;
        }

        .signup-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            width: 100px;
        }

        .cancel-button {
            background-color: #f44336;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            width: 100px;
        }
    </style>
</head>

<body>
    <div class="login-container">
        <header>
            <button class="logo-button">
                <img src="./assets/images/icons/Flame_logo2.png" alt="Logo" style="height: 80px;">
            </button>
        </header>
        <main>
            <div class="login-box">
                <h2>Login</h2>
                <form id="login-form">
                    <input type="text" id="ID" class="input-field" placeholder="ID" required>
                    <input type="password" id="PW" class="input-field" placeholder="PW" required>
                    <div class="remember-me">
                        <input type="checkbox" id="remember" name="remember">
                        <label for="remember">Remember ID</label>
                    </div>
                    <p id="error-message" style="display:none; color:red;">아이디 또는 비밀번호가 잘못되었습니다.</p>
                    <button type="submit" class="signin-button">Sign in</button>
                    <button type="button" class="login-signup-button" id="open-signup-window">Sign up</button>
                </form>
            </div>
        </main>
    </div>

    <!-- 회원가입 모달 팝업 -->
    <div id="signup-modal" class="modal">
        <div class="modal-content">
            <span class="close" id="close-signup-modal">&times;</span>
            <img src="./assets/images/icons/Flame_logo2.png" alt="Logo" class="signup-logo" style="height: 80px;">
            <h2>Sign Up</h2>
            <form id="signup-form">
                <input type="text" id="signup-ID" class="input-field" placeholder="ID" required>
                <input type="password" id="signup-PW" class="input-field" placeholder="Password" required>
                <input type="text" id="signup-Nickname" class="input-field" placeholder="Nickname" required>
                <div class="button-container">
                    <button type="submit" class="signup-button">Sign Up</button>
                    <button type="button" class="cancel-button" id="cancel-button">Cancel</button>
                </div>
            </form>
            <p id="signup-error-message" style="display:none; color:red;">회원가입에 실패했습니다. 다시 시도해주세요.</p>
        </div>
    </div>

    <script>
        // 로그인 요청 처리
        document.getElementById('login-form').addEventListener('submit', function (event) {
            event.preventDefault();
            const ID = document.getElementById('ID').value;
            const PW = document.getElementById('PW').value;

            fetch('./assets/php/login.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `ID=${encodeURIComponent(ID)}&PW=${encodeURIComponent(PW)}`,
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        sessionStorage.setItem('loggedIn', 'true');
                        sessionStorage.setItem('ID', data.ID);
                        window.location.href = 'index.php';
                    } else {
                        document.getElementById('error-message').textContent = 'ID 또는 PW가 잘못되었습니다.';
                        document.getElementById('error-message').style.display = 'block';
                    }
                })
                .catch(error => {
                    console.error('로그인 요청 실패:', error);
                });
        });

        // Sign up 버튼 클릭 시 모달 팝업 열기
        document.getElementById('open-signup-window').onclick = function () {
            document.getElementById('signup-modal').style.display = 'flex';
        };

        // 모달 닫기 버튼 클릭 시 모달 팝업 닫기
        document.getElementById('close-signup-modal').onclick = function () {
            document.getElementById('signup-modal').style.display = 'none';
        };

        // Cancel 버튼 클릭 시 모달 팝업 닫기
        document.getElementById('cancel-button').onclick = function () {
            document.getElementById('signup-modal').style.display = 'none';
        };

        // 회원가입 요청 처리
        document.getElementById('signup-form').addEventListener('submit', function (event) {
            event.preventDefault();
            const signupID = document.getElementById('signup-ID').value;
            const signupPW = document.getElementById('signup-PW').value;
            const signupNickname = document.getElementById('signup-Nickname').value;

            // 회원가입 요청 보내기 (변수명은 그대로)
            fetch('./assets/php/signup.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `ID=${encodeURIComponent(signupID)}&PW=${encodeURIComponent(signupPW)}&Nickname=${encodeURIComponent(signupNickname)}`,
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('회원가입이 완료되었습니다.');
                    document.getElementById('signup-modal').style.display = 'none'; // 모달 닫기
                } else {
                    document.getElementById('signup-error-message').style.display = 'block';
                    document.getElementById('signup-error-message').textContent = data.error || '회원가입에 실패했습니다. 다시 시도해주세요.';
                }
            })
            .catch(error => {
                console.error('회원가입 요청 실패:', error);
                document.getElementById('signup-error-message').style.display = 'block';
            });
        });
    </script>
</body>

</html>
